<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <title>Title</title>
    <script src="js/echarts.js"></script>
    <style>
        body {
            background-color: #292c4a;
            color: rgb(24, 174, 156);

        }
        .main {
            width: 100%;
            min-height: 300px;
        }
    </style>
</head>
<body>

<div id="maxiot_cd_chart1_mainchart" class="main"></div>

</body>
</html>

<script src="js/jquery-3.3.1.min.js"></script>
<script src="https://cdn.jsdelivr.net/npm/vue/dist/vue.js"></script>
<script>

    var self = {
        ctx : {
            $ : $,
            echarts : echarts,
            $element : document
        }
    };

    self.data = {
        option : {},
        myChart : {},
        a : 98
    };

    self.onInit = function () {
        self.data.a = 98;
        self.data.myChart = self.ctx.echarts.init(self.ctx.$element.querySelector('#maxiot_cd_chart1_mainchart'));

        self.data.option = {
            tooltip : {
                formatter : "{b} : {c}%"
            },
            series : [
                {
                    name : '刀具磨损',
                    type : 'gauge',
                    startAngle : 210,
                    endAngle : -30,
                    data : [{value : 50, name : '磨损百分比'}],
                    min : 0,
                    max : 100,
                    splitNumber : 2,
                    radius : '80%',
                    axisLine : {
                        lineStyle : {
                            "width" : 10,
                            color : [
                                [0.7, '#4caf50'],
                                [1, '#EAB62A']

                            ]
                        }
                    },
                    axisTick : {show : false},
                    splitLine : {
                        length : 10,
                        lineStyle : {
                            color : 'auto'
                        },
                        show : false
                    },
                    pointer : {
                        width : 3
                    },
                    title : {
                        offsetCenter : [0, '30%'],
                    },
                    axisLabel : {},
                    detail : {

                        fontWeight : 'normal',

                        color : 'rgba(49, 178, 231,1)',
                        offsetCenter : ["0%", "80%"],
                        formatter : function (value) {
                            return "{a|" + value + "}" + "{b|%}";
                        },
                        rich : {
                            a : {
                                fontSize : 56
                            },
                            b : {
                                fontSize : 22,
                                padding : 5,
                                verticalAlign : 'bottom'
                            }
                        }
                    }
                }
            ]
        };
      //  self.data.myChart.setOption(self.data.option, true);
//        setInterval(function () {
//            self.data.option.series[0].data[0].value = self.getData();
//            self.data.myChart.setOption(self.data.option, true);
//        }, 2000);
    };


    self.onDataUpdated = function (data) {
        //  data=JSON.parse(data);    //正式打开
        console.log("chart1:"+data);
        var da = {};
        self.ctx.$.each(data, function (i, obj) {
            eval("da." + obj.k.o + "='" + obj.v + "'");
        });
        self.data.option.series[0].data[0].value = da.tool_wear_ratio;
        self.data.myChart.setOption(self.data.option, true);
    };

    self.onResize = function () {
        self.data.myChart.resize();
    };
    self.onDestroy = function () {

    };
    self.onPendding = function () {

    };

    self.getData = function () {
        if (self.data.a < 0) {
            self.data.a = 98;
        }
        var result = ((100 - self.data.a)).toFixed(0);
        self.data.a = self.data.a - 2;
        return result;
    };

    self.onInit();

</script>