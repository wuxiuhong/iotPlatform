<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <title>Title</title>
    <script src="js/echarts.js"></script>
    <style>
        body {
            background-color: #292c4a;

            color: #0b415d;
        }

        .top-row {
            height: 40px;
            line-height: 40px;
        }

        .col1 {
            width: auto;
            font-size: 14px;
            float: left;
            letter-spacing: 2px;
        }

        .col1 img {
            vertical-align: middle;
        }

        .obj {
            clear: both;
            height: 0px;
            width: 100%;
            min-width: 300px;
            border: 1px solid rgba(24, 174, 156, 0.5);

            border-radius: 0 50% 50% 0;
        }

        .infomore {
            margin-top: 13px;
            width: 16px;
            height: 16px;
            line-height: 16px;
            border-radius: 10px;
            background-color: rgba(254, 254, 254, .5);;
            float: right;
            text-align: center;
            color: rgba(0, 0, 0, .5);
            font-size: 12px;
            font-weight: bold;
        }
    </style>
</head>
<body>

<div id="maxiot_cd_chart3_main" style="width: 100%;height:400px;"></div>
</body>
</html>

<script src="js/jquery-3.3.1.min.js"></script>
<script src="https://cdn.jsdelivr.net/npm/vue/dist/vue.js"></script>
<script>
    var self = {
        ctx: {
            $: $,
            echarts: echarts,
            $element: document
        }
    };

    self.data = {
        option: {},
        myChart:{}
    };

    self.onInit = function () {
        self.data.myChart = self.ctx.echarts.init(self.ctx.$element.querySelector('#maxiot_cd_chart3_main'));
        self.data.option = {
            title : [{
                text : '健康风险变化曲线',
                left : '‘0%',
                top : '0%',
                textStyle : {
                    color : 'rgba(255,255,255,0.5)',
                    fontStyle : 'normal',
                    fontFamily : 'sans-serif',
                    fontSize : 14
                }
            },
                {
                    text : '风险值(0低-1高)',
                    left : '‘0%',
                    top : '10%',
                    textStyle : {
                        color : 'rgba(255,255,255,0.5)',
                        fontStyle : 'normal',
                        fontFamily : 'sans-serif',
                        fontSize : 12
                    }
                }],
            tooltip : {
                trigger : 'axis',
                formatter : function (params) {
                    params = params[0];
                    return "日期  <span style='color:#01c6fd' >" + params.name + "</span><br/>风险值  <span style='color:#01c6fd'>" + params.value + "</span>";
                },
                axisPointer : {
                    type : 'cross',
                    animation : false,
                    label : {
                        backgroundColor : '#505765'
                    }
                },
                textStyle : {
                    color : 'rgba(255,255,255,0.5)'
                }
            },

            xAxis : {
                type : 'category',
                boundaryGap : false,
                name : '日期(天)',
                nameLocation : 'end',
                nameGap : 10,
                axisLine : {
                    lineStyle : {
                        color : 'rgba(255,255,255,0.5)'
                    }
                },
                axisLabel : {
                    formatter : function (value, idx) {
                        var date = new Date(value);
                        return [date.getMonth() + 1, date.getDate()].join('/');
                    },
                    interval : 1
                },
                splitLine : {
                    show : false
                }
            },
            yAxis : {
                type : 'value',
                name : '',
                nameTextStyle : {
                    color : 'rgba(255,255,255,0.5)',
                    fontSize : '14'
                },
                nameGap : 30,
                axisTick : {
                    length : '0'
                },
                axisLine : {
                    lineStyle : {
                        color : 'rgba(255,255,255,0.5)'

                    }
                },
            },
            grid : {
                left : 36,
                top : 90
            },
            visualMap : {
                top : 10,
                right : 10,
                pieces : [{
                    gt : 0,
                    lte : 0.2,
                    color : '#01c5fd'
                }, {
                    gt : 0.2,
                    lte : 0.8,
                    color : '#EAB62A'
                }, {
                    gt : 0.8,
                    lte : 1,
                    color : '#E04F23'
                }],
                outOfRange : {
                    color : '#999'
                },
                show : false
            },
            color : ['#01c5fd', '#EAB62A', 'rgba(224,79,35,0.1)'],
            series : [{
                type : 'line',
                showSymbol : true,
                symbolSize : 0.01,
                smooth : true,
                itemStyle : {
                    normal : {
                        borderWidth : 3,
                        borderColor : 'white',
                        color : 'blue'
                    }
                }
            },
                {
                    name : '低风险',
                    type : 'line',
                    animation : false,
                    areaStyle : {
                        normal : {}
                    },
                    lineStyle : {
                        normal : {
                            width : 3
                        }
                    },
                    markArea : {
                        data : [[{
                            yAxis : '0'
                        }, {
                            yAxis : '0.2'
                        }]]
                    },

                }, {
                    name : '中等风险',
                    type : 'line',
                    animation : false,
                    areaStyle : {
                        normal : {}
                    },
                    lineStyle : {
                        normal : {
                            width : 1
                        }
                    },
                    markArea : {
                        data : [[{
                            yAxis : '0.2'
                        }, {
                            yAxis : '0.8'
                        }]]
                    }
                }, {
                    name : '高风险',
                    type : 'line',
                    animation : false,
                    areaStyle : {
                        normal : {}
                    },
                    lineStyle : {
                        normal : {
                            width : 1
                        }
                    },
                    markArea : {
                        data : [[{
                            yAxis : '0.8'
                        }, {
                            yAxis : '1'
                        }]]
                    }
                }]
        };
        var data=[
            {
                v:'[{"value":0,"date":"2012-05-01"},{"value":0.1,"date":"2012-05-02"},{"value":0.15,"date":"2012-05-03"},{"value":0.17,"date":"2012-05-04"},{"value":0.18,"date":"2012-05-05"},{"value":0.19,"date":"2012-05-06"},{"value":0.25,"date":"2012-05-07"},{"value":0.26,"date":"2012-05-08"},{"value":0.29,"date":"2012-05-09"},{"value":0.30,"date":"2012-05-10"},{"value":0.34,"date":"2012-05-11"},{"value":0.35,"date":"2012-05-12"},{"value":0.40,"date":"2012-05-13"},{"value":0.44,"date":"2012-05-14"},{"value":0.46,"date":"2012-05-15"},{"value":0.50,"date":"2012-05-16"},{"value":0.55,"date":"2012-05-17"},{"value":0.56,"date":"2012-05-18"},{"value":0.60,"date":"2012-05-19"},{"value":0.65,"date":"2012-05-20"},{"value":0.68,"date":"2012-05-21"},{"value":0.70,"date":"2012-05-22"},{"value":0.75,"date":"2012-05-23"},{"value":0.77,"date":"2012-05-24"},{"value":0.78,"date":"2012-05-25"},{"value":0.80,"date":"2012-05-26"},{"value":0.85,"date":"2012-05-27"},{"value":0.88,"date":"2012-05-28"},{"value":0.90,"date":"2012-05-29"},{"value":0.95,"date":"2012-05-30"}]',
                t:1528358866224,
                k:{o:"spindle_health",l:"spindle_health"}
            }];
        self.onDataUpdated(data);
    };

    self.onDataUpdated = function (data) {
        var da={};
        self.ctx.$.each(data, function (i, obj) {
           da[obj.k.o] = obj.v;
        });
        da.spindle_health=eval(da.spindle_health);
        self.data.option.xAxis.data = da.spindle_health.map(function (item) {
            return item.date;
        });
        self.data.option.series[0].data = da.spindle_health.map(function (item) {
            return item.value;
        });
        self.data.myChart.setOption(self.data.option, true);
    };

   self.onResize = function () {
       self.data.myChart.resize();
    };
    self.onDestroy = function () {
    };
    self.onPendding = function () {
    };

    self.onInit();

</script>