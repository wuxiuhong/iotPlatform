<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <title>Title</title>
    <style>
        body{
            background-color: #292c4a;
            color:rgb(24, 174, 156);

        }
        .top-row{
            height: 40px;
            line-height: 40px;
        }
        .col1{
            width:auto;
            font-size:14px;
            float:left;
            letter-spacing: 2px;
        }
        .col1 img{
            vertical-align: middle;
        }
        .obj {
            clear:both;
            height: 0px;
            width:100%;
            min-width:300px;
            border: 1px solid rgba(24, 174, 156,0.5);

            border-radius: 0 50% 50% 0;
        }
        .infomore{
            margin-top:13px;
            width:16px;
            height:16px;
            line-height:16px;
            border-radius:10px;
            background-color: rgba(254,254,254,.5);;
            float:right;
            text-align:center;
            color:rgba(0,0,0,.5);
            font-size:12px;
            font-weight:bold;
        }
        .leftdiv{
            float:left;
            width:100px;
            height:100px;
            line-height:100px;
            font-size:50px;
            text-align: left;
            font-weight: normal;
            color:rgb(1, 198, 253);
        }
        .rightdiv{
            float:left;
            width:calc(100% - 110px);
            margin-left:10px;
            margin-top:15px;
        }
        .txtdiv{
            color:rgba(255,255,255,0.5);
            font-size:14px;
            font-weight: normal;
        }
        .barLife div{
            width:4px;
            height: 35px;
            border-radius: 10px;
            background-color: rgba(255,255,255,0.3);
            float:left;
            margin-right:5px;
        }
        .bottomdiv{
            margin-top:10px;
        }
        em{
            font-size:18px;
            font-style:normal;
        }
        .rightdiv span{
            color:rgba(255,255,255,0.5);
            font-weight: 100;
        }
        .left{
            float:left;
            width:75%;
        }
        .right{
            float:left;
            width:calc(25% - 60px);
            text-align: left;
            padding-left:60px;
        }
        .righttxt{
            font-size:14px;
            color:rgba(255,255,255,0.5);
            font-weight:100;
        }
        .right-sub-txt{
            font-size:50px;
            color:rgb(1, 198, 253);
            font-weight:100;
        }
        .alarm{
            color: rgb(224, 79, 35);
        }
        .warn{
            color: #EAB62A;
        }
        .ok{
            color:rgba(49, 178, 231,1);
        }
    </style>

</head>
<body>
<div class="top-row">
    <div class="col1"><img src="svg/bullet/green.svg"/>&nbsp;&nbsp;刀具剩余寿命</div>
    <div class="infomore">i</div>
</div>
<div style="height: 100px;">

    <div class="left">
        <div class="leftdiv" id="tool_rul_perc">70<em>%</em></div>
        <div class="rightdiv">
            <div style="width:100%;"><span>0</span><span style="padding-left:calc(50% - 20px)">50</span><span style="padding-left:calc(50% - 50px)">100</span></div>
            <div class="barLife"></div>
        </div>
    </div>
    <div class="right">
        <div class="righttxt">刀具剩余寿命</div>
        <div class="right-sub-txt" id="tool_rul">122<em>min</em></div>
    </div>
   </div>
</body>
</html>
<script src="js/jquery-3.3.1.min.js"></script>
<script src="https://cdn.jsdelivr.net/npm/vue/dist/vue.js"></script>
<script>


var  da= {},
    i= 1,
        a=0,
        mockdata=[];

   var init=function(){
        var width=$(".barLife").width();
        var bar=$(".barLife");
        bar.empty();
        var n=width/9;
        for(var i=1;i<n;i++){
            $(".barLife").append("<div></div>");
        }
    };

   var set=function(percent,tool_wear){
        var width=$(".barLife").width();
        var newwidth=(percent/100.0)*width;
        var n=newwidth/9;
        $(".barLife div").css("background-color","rgba(255,255,255,0.3)");
        for(var i=0;i<n;i++){
            if(tool_wear<0.2){
                $(".barLife div").eq(i).css("background-color","rgb(224, 79, 35)");
            }
            else if(tool_wear<0.8){
                $(".barLife div").eq(i).css("background-color","#EAB62A");
            }
            else{
                $(".barLife div").eq(i).css("background-color","rgba(49, 178, 231, 0.8)");
            }
        }
        if(tool_wear<0.2){
            $("#tool_rul_perc").removeClass("ok").removeClass("warn").addClass("alarm");
            $("#tool_rul").removeClass("ok").removeClass("warn").addClass("alarm");
        }
        else if(tool_wear<0.8){
            $("#tool_rul_perc").removeClass("ok").removeClass("alarm").addClass("warn");
            $("#tool_rul").removeClass("ok").removeClass("alarm").addClass("warn");
        }
        else{
            $("#tool_rul_perc").removeClass("alarm").removeClass("warn").addClass("ok");
            $("#tool_rul").removeClass("alarm").removeClass("warn").addClass("ok");
        }
        $("#tool_rul_perc").html(percent+"<em>%</em>");
    };

    $(window).resize(function() {
        init();
        set($("#tool_rul_perc").html());
    });

 var  onInit=function(){
       init();
       mockdata=   [{"tool_wear": "1.0248631137316073", "tool_wear_pred": "[]", "tool_rul": "30", "tool_rul_perc": "1.0"},
           {"tool_wear": "1.0386530152740175", "tool_wear_pred": "[]", "tool_rul": "29", "tool_rul_perc": "0.967"},
           {"tool_wear": "1.0108516052532324", "tool_wear_pred": "[]", "tool_rul": "28", "tool_rul_perc": "0.937"},
           {"tool_wear": "1.0230706280181004", "tool_wear_pred": "[]", "tool_rul": "27", "tool_rul_perc": "0.9"},
           {"tool_wear": "0.995844405068224", "tool_wear_pred": "[]", "tool_rul": "26", "tool_rul_perc": "0.867"},
           {"tool_wear": "1.020418995953353", "tool_wear_pred": "[]", "tool_rul": "25", "tool_rul_perc": "0.833"},
           {"tool_wear": "0.9962380352171709", "tool_wear_pred": "[]", "tool_rul": "24", "tool_rul_perc": "0.766666667"},
           {"tool_wear": "1.03548539492709", "tool_wear_pred": "[]", "tool_rul": "23", "tool_rul_perc": "0.7"},
           {"tool_wear": "1.0459856981268421", "tool_wear_pred": "[]", "tool_rul": "22", "tool_rul_perc": "0.666666667"},
           {"tool_wear": "1.0518477856908957", "tool_wear_pred": "[]", "tool_rul": "21", "tool_rul_perc": "0.633333333"},
           {"tool_wear": "1.0325671991118395", "tool_wear_pred": "[]", "tool_rul": "20", "tool_rul_perc": "0.6"},
           {"tool_wear": "1.0328611382547717", "tool_wear_pred": "[]", "tool_rul": "19", "tool_rul_perc": "0.566666667"},
           {"tool_wear": "1.0250958081751844", "tool_wear_pred": "[]", "tool_rul": "18", "tool_rul_perc": "0.533333333"},
           {"tool_wear": "1.012092089094648", "tool_wear_pred": "[]", "tool_rul": "17", "tool_rul_perc": "0.466666667"},
           {"tool_wear": "1.0075849712911238", "tool_wear_pred": "[]", "tool_rul": "16", "tool_rul_perc": "0.433333333"},
           {"tool_wear": "0.9787613830285989", "tool_wear_pred": "[]", "tool_rul": "15", "tool_rul_perc": "0.4"},
           {"tool_wear": "0.9669877628915108", "tool_wear_pred": "[]", "tool_rul": "14", "tool_rul_perc": "0.366666667"},
           {"tool_wear": "0.9496547369436008", "tool_wear_pred": "[]", "tool_rul": "13", "tool_rul_perc": "0.333333333"},
           {"tool_wear": "0.9171396271845964", "tool_wear_pred": "[]", "tool_rul": "12", "tool_rul_perc": "0.3"},
           {"tool_wear": "0.9181136276172355", "tool_wear_pred": "[]", "tool_rul": "11", "tool_rul_perc": "0.266666667"},
           {"tool_wear": "0.9227071427128337", "tool_wear_pred": "[0.88178031 ,0.8604292 , 0.83791339 ,0.81423289, 0.78938769 ,0.76337781 ,0.73620323, 0.70786395, 0.67835999, 0.64769133]", "tool_rul": "10", "tool_rul_perc": "0.233333333"},
           {"tool_wear": "0.8973814696355247", "tool_wear_pred": "[0.86681149, 0.84540564 ,0.82291218 ,0.79933112 ,0.77466244, 0.74890614 ,0.72206224 ,0.69413072, 0.66511159 ,0.63500486]", "tool_rul": "10", "tool_rul_perc": "0.233333333"},
           {"tool_wear": "0.877867095032775", "tool_wear_pred": "[0.84973175, 0.82795931, 0.80514733 ,0.7812958 , 0.75640473 ,0.73047411, 0.70350395, 0.67549425, 0.646445 ,  0.61635621]", "tool_rul": "9", "tool_rul_perc": "0.2"},
           {"tool_wear": "0.8645913790647765", "tool_wear_pred": "[0.83353167, 0.81161126 ,0.78870847, 0.76482328 ,0.7399557 , 0.71410573 ,0.68727336, 0.65945861, 0.63066146, 0.60088193]", "tool_rul": "9", "tool_rul_perc": "0.2"},
           {"tool_wear": "0.8381275003873718", "tool_wear_pred": "[0.81326576, 0.7906175 , 0.76700257, 0.74242095 ,0.71687265 ,0.69035768 ,0.66287602 ,0.63442769 ,0.60501267 ,0.57463098]", "tool_rul": "8", "tool_rul_perc": "0.166666667"},
           {"tool_wear": "0.8466856025472931", "tool_wear_pred": "[0.80218591, 0.78028481 ,0.75751904, 0.73388861 ,0.70939352, 0.68403376, 0.65780933 ,0.63072024 ,0.60276649 ,0.57394807]", "tool_rul": "8", "tool_rul_perc": "0.166666667"},
           {"tool_wear": "0.8343053909262558", "tool_wear_pred": "[0.7909913 , 0.76975504 ,0.74774201, 0.72495222 ,0.70138566 ,0.67704234, 0.65192226, 0.62602542 ,0.59935181, 0.57190145]", "tool_rul": "8", "tool_rul_perc": "0.166666667"},
           {"tool_wear": "0.8151772951052989", "tool_wear_pred": "[0.7775291 , 0.75658836, 0.73493043 ,0.7125553,  0.68946298 ,0.66565347, 0.64112677 ,0.61588288 ,0.5899218 , 0.56324352]", "tool_rul": "7", "tool_rul_perc": "0.133333333"},
           {"tool_wear": "0.8114645483539122", "tool_wear_pred": "[0.76712005 ,0.74686634, 0.72597093, 0.70443383 ,0.68225504 ,0.65943455, 0.63597236 ,0.61186848 ,0.5871229 , 0.56173563]", "tool_rul": "7", "tool_rul_perc": "0.133333333"},
           {"tool_wear": "0.7812755053357727", "tool_wear_pred": "[0.75111298, 0.73076552, 0.70980492, 0.68823115 ,0.66604423, 0.64324415 ,0.61983092, 0.59580453, 0.57116498, 0.54591228]", "tool_rul": "7", "tool_rul_perc": "0.133333333"},
           {"tool_wear": "0.7583333044158993", "tool_wear_pred": "[0.73286175, 0.71216317, 0.69086466, 0.66896624, 0.64646789 ,0.62336962 ,0.59967143, 0.57537331, 0.55047527, 0.52497731]", "tool_rul": "6", "tool_rul_perc": "0.1"},
           {"tool_wear": "0.7355387232024841", "tool_wear_pred": "[0.71291607, 0.69170882 ,0.66990613 ,0.64750799 ,0.6245144 , 0.60092536 ,0.57674088 ,0.55196094 ,0.52658556, 0.50061472]", "tool_rul": "5", "tool_rul_perc": "0.066666667"}];

       setInterval(function () {
           var datanow=getData();
           var data=[
               {
                   v:datanow.tool_rul_perc,
                   t:1528358866224,
                   k:{o:"tool_rul_perc",l:"tool_rul_perc"}
               },
               {
                   v:datanow.tool_rul,
                   t:1528358866224,
                   k:{o:"tool_rul",l:"tool_rul"}
               }
           ];
           onDataUpdated(data);
       },2000);
    };
  var  onDataUpdated=function(data){
        $.each(data,function(i,obj){

            eval("da."+obj.k.o+"='"+obj.v+"'");
        });
        set((da.tool_rul_perc*100).toFixed(0),da.tool_wear);
       $("#tool_rul").html(da.tool_rul+"<em>min</em>");
    };
    onResize=function(){

    };
    onDestroy=function(){

    };
    onPendding=function(){

    };

   var getData=function(){
        var cd=mockdata[a];
        a++;
        if(a==mockdata.length){
            a=0;
        }
        return {
            tool_rul:cd.tool_rul,
            tool_rul_perc:cd.tool_rul_perc,
            tool_wear:cd.tool_wear
        }
    };

    onInit();
</script>