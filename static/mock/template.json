{
  "templates": [
    {
      "id": "3f825d20-fe01-11e7-83b5-9b9f49d154f1",
      "version": "1.0.0",
      "name": "主轴健康风险监测图表",
      "type": "html",
      "templateType": "组件模板类型",
      "image": "缩略图",
      "createTime": "2018-5-28",
      "template": {
        "dependent": [],
        "templateHtml": "<div> <div class=\"txtdiv\" @click=\"onClick\">{{title}}</div> <div class=\"bottomdiv\"> <div class=\"leftdiv\" id=\"spindle_fcft_score\">0</div> <div class=\"rightdiv\"> <div style=\"width:100%;\"><span>0</span><span style=\"padding-left:calc(50% - 20px)\">0.5</span><span style=\"padding-left:calc(50% - 50px)\">1.0</span></div> <div class=\"bar\"></div> </div> </div> </div>",
        "templateCss": ".leftdiv{ float:left; width:80px; height:65px; line-height:75px; font-size:50px; text-align: center; font-weight: normal; } .rightdiv{ float:left; width:calc(100% - 95px); margin-left:10px; } .txtdiv{ color:rgba(255,255,255,0.5); font-size:14px; font-weight: normal; } .bar div{ width:4px; height: 35px; border-radius: 10px; background-color: rgba(255,255,255,0.3); float:left; margin-right:5px; } .bottomdiv{ margin-top:10px; } em{ font-size:18px; } .rightdiv span{ color:rgba(255,255,255,0.5); } .alarm{ color: rgb(224, 79, 35); } .warn{ color: #EAB62A; } .ok{ color:rgba(49, 178, 231,1); }",
        "controllerScript": "self.data = { da: {}, i: 1 }; self.onInit = function () { var width = self.ctx.$(\".bar\").width(); var bar = self.ctx.$(\".bar\"); bar.empty(); var n = width / 9; for (var i = 1; i < n; i++) { self.ctx.$(\".bar\").append(\"<div></div>\"); } setInterval(function () { var da = self.getstatus(); var data = [ { v: da.spindle_fcft_score, t: 1528358866224, k: {o: \"spindle_fcft_score\", l: \"spindle_fcft_score\"} }, { v: da.spindle_alarm, t: 1528358866224, k: {o: \"spindle_alarm\", l: \"spindle_alarm\"} }, { v: da.spindle_warn, t: 1528358866224, k: {o: \"spindle_warn\", l: \"spindle_warn\"} } ]; self.onDataUpdated(data); }, 2000); }; self.onResize = function () { self.onDataUpdated(\"重置\") }; self.onDataUpdated = function (data) { self.ctx.$.each(data, function (i, obj) { eval(\"self.data.da.\" + obj.k.o + \"='\" + obj.v + \"'\"); }); self.set(self.data.da.spindle_fcft_score, self.data.da.spindle_alarm, self.data.da.spindle_warn); }; self.onDestroy = function () { console.log(\"销毁\") }; self.set = function (percent, spindle_alarm, spindle_warn) { var width = self.ctx.$(\".bar\").width(); var newwidth = percent * width; var n = newwidth / 9; self.ctx.$(\".bar div\").css(\"background-color\", \"rgba(255,255,255,0.3)\"); for (var i = 0; i < n; i++) { if (spindle_alarm == 1) { self.ctx.$(\".bar div\").eq(i).css(\"background-color\", \"rgb(224, 79, 35)\"); } else if (spindle_warn == 1) { self.ctx.$(\".bar div\").eq(i).css(\"background-color\", \"#EAB62A\"); } else { self.ctx.$(\".bar div\").eq(i).css(\"background-color\", \"rgba(49, 178, 231, 0.8)\"); } } if (spindle_alarm == 1) { self.ctx.$(\"#spindle_fcft_score\").removeClass(\"ok\").removeClass(\"warn\").addClass(\"alarm\"); } else if (spindle_warn == 1) { self.ctx.$(\"#spindle_fcft_score\").removeClass(\"ok\").removeClass(\"alarm\").addClass(\"warn\"); } else { self.ctx.$(\"#spindle_fcft_score\").removeClass(\"alarm\").removeClass(\"warn\").addClass(\"ok\"); } self.ctx.$(\"#spindle_fcft_score\").html(percent); }; self.getstatus = function () { var spindle_alarm = 0, spindle_warn = 0, spindle_fcft_score = 0; if (self.data.i < 0) { self.data.i = 1; } if (self.data.i < 0.2) { spindle_fcft_score = self.data.i; spindle_alarm = 1; spindle_warn = 0; } else if (self.data.i < 0.8) { spindle_fcft_score = self.data.i; spindle_alarm = 0; spindle_warn = 1; } else { spindle_fcft_score = self.data.i; spindle_alarm = 0; spindle_warn = 0; } self.data.i = (self.data.i - 0.1).toFixed(1); return { spindle_fcft_score: spindle_fcft_score, spindle_alarm: spindle_alarm, spindle_warn: spindle_warn }; }; self.onClick = function () { console.log(\"click\"); };",
        "defaultData": {
          "title": "健康值"
        },
        "dataSources": []
      }
    }
  ]
}